<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<style type="text/css">
body {
font-family:Arial, Helvetica, sans-serif;
}
#container{
border:5px solid grey;
width:800px;
margin:0 auto;
padding:10px;
}
#chatLog{
padding:5px;
border:1px solid black;
}
#chatLog p {
margin:0;
}
.event {
color:#999;
}
.warning{
font-weight:bold;
color:#CCC;
}
</style>
<script type="application/javascript">
$(document).ready(function(){

function message(msg){
$('#chatLog').append(msg+'</p>');
}

var socket;
var host = "ws://typing-for-war.herokuapp.com:80/socket/server";


function connect(){
    try{

    socket = new WebSocket(host);

        message('<p class="event">Socket Status: '+socket.readyState);

        socket.onopen = function(){
     message('<p class="event">Socket Status: '+socket.readyState+'(open)');
        }

        socket.onmessage = function(msg){
     message('<p class="message">Received: '+msg.data);
        }

        socket.onclose = function(){
     message('<p class="event">Socket Status: '+socket.readyState+'(Closed)');
    }
        socket.onerror = function(e){
     message('<p class="event">Socket Status: '+socket.readyState+'(Error):' + e);
    }

    } catch(exception){
     message('<p>Error'+exception);
    }
}
connect();


function send(){

    var text = $('#text').val();
    if(text==""){
        message('<p class="warning">Please enter a message');
        return ;
    }
    try{
        socket.send(text);
        message('<p class="event">Sent: '+text)
    } catch(exception){
  message('<p class="warning"> Error:' + exception);
    }

    $('#text').val("");

}

$('#text').keypress(function(event) {
    if (event.keyCode == '13') {
  send();
    }
});

$('#disconnect').click(function(){
  socket.close();
});



})
</script>
<title>WebSockets Client</title>

</head>
<body>
<div id="wrapper">

    <div id="container">

        <h1>WebSockets Client</h1>

        <div id="chatLog">

        </div><!-- #chatLog -->
        <p id="examples">e.g. try 'hi', 'name', 'age', 'today'</p>

        <input id="text" type="text" />
        <button id="disconnect">Disconnect</button>

    </div><!-- #container -->

</div>
</body>
</html>
